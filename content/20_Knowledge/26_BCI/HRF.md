---
publish: true
---
**HRF（Hemodynamic Response Function，血流动力学反应函数）** 是 fMRI 数据分析中最基础、最核心的物理模型。它是连接“神经元活动”与“核磁共振信号”的桥梁。

如果不理解 HRF，就无法理解 fMRI 到底在测什么。以下我从原理、形状、数学作用以及 **NSD 论文中的特殊处理** 四个方面详细讲解。

---

### 1. 核心原理：为什么会有 HRF？

fMRI 并不是直接测量神经元的放电（电信号），而是测量**血氧水平的变化**（BOLD 信号）。

*   **神经血管耦合（Neurovascular Coupling）：**
    1.  当大脑某个区域（比如视觉皮层）的神经元兴奋时，它们会消耗氧气。
    2.  大脑血管系统会迅速做出反应，向该区域输送大量富含氧气的血液。
    3.  **关键点：** 身体的供血通常是“过度补偿”的——送来的氧气比消耗的还要多。
    4.  这导致该区域的**氧合血红蛋白（抗磁性）**比例增加，**脱氧血红蛋白（顺磁性）**比例减少。
    5.  磁场性质的改变导致 fMRI 信号增强。

**HRF 就是描述这一连串生理反应随时间变化的过程。** 简单说：HRF 告诉我们，**如果神经元“闪”了一下（持续极短的活动），fMRI 信号在接下来的 30 秒内会怎么波动。**

---

### 2. 标准 HRF 的形状（The Canonical Shape）

一个典型的 HRF 曲线通常包含三个阶段（由于血液流动很慢，这个过程非常漫长）：

1.  **初始下降（Initial Dip，有时不可见）：**
    *   神经元刚开始消耗氧气，但新血还没送到，信号会轻微下降。
2.  **主峰（Peak / Overshoot）：**
    *   **时间：** 刺激后约 **4-6 秒**达到顶峰。
    *   这是我们在分析中主要捕捉的信号。大量新鲜血液涌入，信号强度达到最大。
3.  **下冲（Undershoot）：**
    *   **时间：** 刺激后约 **10-20 秒**。
    *   血流量恢复正常了，但血管还扩张着，导致血容量增加，信号跌落到基线以下。
4.  **恢复基线：**
    *   整个过程大约需要 **20-30 秒** 才能彻底结束。

**重要启示：** 神经活动是毫秒级的，但 BOLD 反应是秒级的（非常迟钝）。

---

### 3. HRF 在 GLM 分析中的数学作用：卷积（Convolution）

在 NSD 实验中，图片每 4 秒出现一次，但 HRF 持续 30 秒。这意味着：**第一张图片引起的血流还没结束，第二张、第三张图片的反应就叠加上去了。**

为了解决这个问题，我们需要用到**线性时不变假设（LTI）**和**卷积**：

*   **假设：** fMRI 信号是线性叠加的。如果一张图片产生 1 个单位的波峰，两张图片同时出现就产生 2 个单位的波峰。
*   **计算：**
    $$ \text{预测信号} = \text{刺激时间点} \otimes \text{HRF} $$
    即：我们将实验设计的“刺激时间点”（0和1的序列）与“HRF 曲线”进行**卷积**运算。
*   **结果：** 运算结果就是我们预期的、波动起伏的 fMRI 信号模型（Design Matrix）。然后我们将这个模型去和真实数据做回归，算出的系数就是 Beta 值（反应强度）。

---

### 4. NSD 论文中的创新：HRF 库（Library of HRFs）

这是这篇论文在方法上的一个**重大改进**。

#### 传统方法的缺陷
大多数 fMRI 研究假设**全人类、全脑**都使用同一个标准的 HRF 形状（SPM Canonical HRF）。
*   **问题：** 这是一个巨大的过度简化。
    *   **个体差异：** 你血液流动的速度可能比我快。
    *   **脑区差异：** 初级视觉皮层（V1）的血管反应非常快，而额叶或顶叶的反应可能较慢。
*   **后果：** 如果你的模型假设波峰在第 6 秒，但实际体素的波峰在第 4 秒，模型就会匹配失败，导致算出的 Beta 值不准（低估反应强度）。

#### NSD 的解决方案（GLMsingle）
作者不想用“均码”模型，而是想为每个体素“量身定做”HRF。

1.  **建立 HRF 库：**
    *   他们分析了第一次扫描的数据，找出了全脑最常见的反应模式。
    *   通过主成分分析（PCA），他们提炼出了 **20 种** 不同的 HRF 曲线形状。有的波峰早（比如 4s），有的波峰晚（比如 7s），有的下冲深，有的下冲浅。
    
2.  **为每个体素选秀：**
    *   对于大脑中的每一个体素（比如体素 A），算法会尝试用这 20 种 HRF 分别去拟合数据。
    *   **优胜劣汰：** 哪一种形状能最好地解释体素 A 的数据（方差解释率 $R^2$ 最高），体素 A 就**选定**这种 HRF。
    
3.  **计算 Beta 值：**
    *   使用选定的那个特定 HRF 来计算该体素对单次试次的反应强度。

### 总结

*   **HRF 是什么？** 它是大脑受到刺激后，血液动力学的“回声”。
*   **为什么重要？** 因为 fMRI 测的是这个“回声”，而不是神经元的声音。我们需要用 HRF 函数把“声音”推导出来。
*   **NSD 的贡献：** 它没有假设所有的回声听起来都一样，而是允许每个脑区拥有自己独特的“回声形状”（从 20 种形状中选择），从而极大地提高了测量的准确性。